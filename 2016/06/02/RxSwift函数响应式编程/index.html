<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="iOS Swift Objective-C"><title>RxSwift函数响应式编程 | Hale's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">RxSwift函数响应式编程</h1><a id="logo" href="/.">Hale's Blog</a><p class="description">stay hungry stay foolish</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">RxSwift函数响应式编程</h1><div class="post-meta">Jun 2, 2016<span> | </span><span class="category"><a href="/categories/iOS/">iOS</a></span></div><div class="post-content"><h2 id="Why-use-RxSwift"><a href="#Why-use-RxSwift" class="headerlink" title="Why use RxSwift?"></a>Why use RxSwift?</h2><p>我们使用Swift编写iOS应用程序时，总是需要处理大量的外部响应事件。例如：利用@IBAction或Target-action响应用户的操作事件；设置Notification监听键盘的位置变化；使用closure异步处理网络请求返回的数据；使用KVO监听属性的变化，以做出相应操作等。各种各样的事件响应方式，无形中增加了编码的复杂度。是否有一种编码规范能够使用统一的接口处理以上的事件响应方式。ReactiveX就是这么一个系统，它是一个响应式编程规范集合。由它定义的RxSwift为我们在开发iOS应用程序时，解决以上问题提供了统一的解决方案。</p>
<h2 id="What-is-RxSwift"><a href="#What-is-RxSwift" class="headerlink" title="What is RxSwift?"></a>What is RxSwift?</h2><p>RxSwift中的Observable<element> 是观察者模式中被观察的对象，相当于一个事件序列 (GeneratorType) ，会主动向订阅者发送新产生的事件信息。事件类型分为以下三种：</element></p>
<ul>
<li>.Next(value) 表示新的事件数据。</li>
<li>.Completed 表示事件序列的完结</li>
<li>.Error 同样表示完结，但是代表异常导致的完结。</li>
</ul>
<h2 id="How-RxSwift-work"><a href="#How-RxSwift-work" class="headerlink" title="How RxSwift work?"></a>How RxSwift work?</h2><h4 id="Observable-被观察者"><a href="#Observable-被观察者" class="headerlink" title="Observable(被观察者)"></a>Observable(被观察者)</h4><p>要得到一个Observable有两种方式，一种是RxSwift已经提供了的（这里你可能需要引入RxCocoa），一种是自己创建。比如你有一个UITextfield，你要订阅其text的变化，就可以通过textfield.rx_text来获得这个Observable<string>的对象。如果要自己创建的话，可以利用它提供的create函数来创建，create接受函数闭包作为参数。</string></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">(1) let observable = textField.rx_text</div><div class="line"></div><div class="line">(2) let observable = &#123; (element: String) -&gt; Observable&lt;String&gt; in</div><div class="line">        return Observable.create &#123; observer in</div><div class="line">            observer.on(.Next(element))</div><div class="line">            observer.on(.Completed)</div><div class="line">            return NopDisposable.instance</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="Subscribe（订阅）"><a href="#Subscribe（订阅）" class="headerlink" title="Subscribe（订阅）"></a>Subscribe（订阅）</h4><p>如果只有一个Observable被创建，而没有被任何订阅者所订阅，那么什么事情也不会发生，事件触发时，被订阅者所定义的事件处理也不会被如期执行，这不是我们所希望的。所以我们需要创建一个订阅者，用于响应事件的触发。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">let disposeBag = DisposeBag()</div><div class="line">    </div><div class="line">    let myJust = &#123; (element: String) -&gt; Observable&lt;String&gt; in</div><div class="line">        return Observable.create &#123; observer -&gt; Disposable in</div><div class="line">            observer.on(.Next(element))</div><div class="line">            observer.on(.Completed)</div><div class="line">            return NopDisposable.instance</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">myJust(&quot;🐹&quot;)</div><div class="line">    .subscribe &#123; print($0) &#125;</div><div class="line">    .addDisposableTo(disposeBag)</div><div class="line"></div><div class="line">--- create example ---</div><div class="line">Next(🐹)</div><div class="line">Completed</div></pre></td></tr></table></figure>
<h4 id="Subject"><a href="#Subject" class="headerlink" title="Subject"></a>Subject</h4><p>简单的比喻下，Observable像是一个水管，会源源不断的有水冒出来。Subject就像一个水龙头，它可以套在水管上，接受Observable上面的事件。但是作为水龙头，它下面还可以被别的observer给subscribe。</p>
<p>在RxSwift中，主要有三类Subject：</p>
<ul>
<li>PublishSubject</li>
</ul>
<p>它仅仅会发送observer订阅之后的事件，也就是说如果sequence上有.Next 的到来，但是这个时候某个observer还没有subscribe它，这个observer就收不到这条信息，它只会收到它订阅之后发生的事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">let disposeBag = DisposeBag()</div><div class="line">    let subject = PublishSubject&lt;String&gt;()</div><div class="line">    subject.onNext(&quot;🅰️&quot;)</div><div class="line">    subject</div><div class="line">        .subscribeNext&#123; print(&quot;event:\($0)&quot;) &#125;</div><div class="line">        .addDisposableTo(disposeBag)</div><div class="line">    subject.onNext(&quot;🐶&quot;)</div><div class="line">    subject.onNext(“🐱&quot;)</div><div class="line">    </div><div class="line">--- PublishSubject example ---</div><div class="line">event:🐶</div><div class="line">event:🐱</div></pre></td></tr></table></figure>
<ul>
<li>ReplaySubject</li>
</ul>
<p>它和PublishSubject不同之处在于它不会漏消息。即使observer在subscribe的时候已经有事件发生过了，它也会收到之前的事件序列。</p>
<ul>
<li>BehaviorSubject</li>
</ul>
<p>当有observer在订阅一个BehaviorSubject的时候，它首先将会收到Observable上最近发送一个信号（或者是默认值），接着才会收到Observable上会发送的序列。</p>
<ul>
<li>Variable</li>
</ul>
<p>Variable是BehaviorSubject的封装，它和BehaviorSubject不同之处在于，不能向Variable发送.Complete和.Error，它会在生命周期结束被释放的时候自动发送.Complete。</p>
</div><div class="tags"><a href="/tags/RxSwift/">RxSwift</a></div><div class="post-nav"><a href="/2016/06/08/fastlane gym实现ipa自动打包脚本/" class="pre">使用fastlane gym实现ipa自动打包脚本</a><a href="/2016/06/02/Swift中的生成器和序列/" class="next">Swift中的生成器和序列</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://wuqiuhao.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/GeneratorType/" style="font-size: 15px;">GeneratorType</a> <a href="/tags/SequenceType/" style="font-size: 15px;">SequenceType</a> <a href="/tags/RxSwift/" style="font-size: 15px;">RxSwift</a> <a href="/tags/UILabel/" style="font-size: 15px;">UILabel</a> <a href="/tags/Database/" style="font-size: 15px;">Database</a> <a href="/tags/自动打包/" style="font-size: 15px;">自动打包</a> <a href="/tags/AVPlayerViewController/" style="font-size: 15px;">AVPlayerViewController</a> <a href="/tags/Custom-Transition/" style="font-size: 15px;">Custom Transition</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/17/WCDB理解/">WCDB理解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/17/iOS自定义模态视图转场/">iOS自定义模态视图转场</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/08/fastlane gym实现ipa自动打包脚本/">使用fastlane gym实现ipa自动打包脚本</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/02/RxSwift函数响应式编程/">RxSwift函数响应式编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/02/Swift中的生成器和序列/">Swift中的生成器和序列</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/05/iOS视频、音频播放/">iOS视频、音频播放</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/30/UILabel垂直方向布局调整——实现居上居下效果/">UILabel垂直方向布局调整——实现居上居下效果</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Hale's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>